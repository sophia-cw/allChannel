var emailValidated=!0,ROCIDValidated=!0,fromSpecify=!1,mobileValidated=!0;function checkIfTitleNeedsToHide(e,t,i){for(var a,n=0;n<$(".section").size();n++)e<=(a=Number($(".section").eq(n).attr("tabindex"))+1)&&a<=t&&(i?$(".section").eq(n).show():$(".section").eq(n).hide())}function showTitle(e,t,i){for(var a,n=0;n<$(".section").size();n++)e<=(a=parseInt($(".section").eq(n).attr("tabindex"))+1)&&a<=t&&(i?$(".section").eq(n).show():$(".section").eq(n).hide())}function DateIsValid(e){if("___/__/__"==e)return!0;var t=e.split("/"),i=Number(t[0])+1911,a=Number(t[1]),n=Number(t[2]),r=!0;return!isNaN(i)&&!isNaN(a)&&!isNaN(n)&&(0!=a&&0!=n||(r=!1),2==a?29==n?r=i%4==0&&(i%100!=0||i%400==0):28<n&&(r=!1):4==a||6==a||9==a||11==a?30<n&&(r=!1):(31<n&&(r=!1),12<a&&(r=!1))),1!=t.length?!(-1!=t[0].indexOf("_")&&"___"!=t[0]||-1!=t[1].indexOf("_")&&"__"!=t[0]||-1!=t[2].indexOf("_")&&"__"!=t[0])&&r:r}function nextPage(e){var t=$(e).attr("accesskey").toString(),i=(parseInt($(e).attr("accesskey"))+1).toString(),a=!0,n="";if($(".field:visible",$("#page"+t+":visible")).each(function(){dform.validateQ($(this))||(a=!1,n+=$(this).attr("accesskey")+",")}),""!=n&&(n=n.substring(0,n.length-1),alert(res_PleaseCompleteTheRequiredFields+": ")),0==a&&($("input:button").removeAttr("disabled"),$("div.ValError").show()),1==a){var r,s,d,l=$("#page"+t),o=!1,c=$(".field[jump]",$(l)).last();if($("a",$(c)).each(function(){$(this).hasClass("selected")&&(o=!0,r=this)}),o){s=parseInt($(r).attr("accesskey"));var h=!0;if($(".field").each(function(){parseInt($(this).attr("accesskey"))==s&&((d=parseInt($(this).parents('[id*="page"]').attr("id").replace("page","")))==t&&d++,h=!1)}),h)d=parseInt($("#tpage").val()),$(".field",$("#page"+d)).each(function(){$(this).hide()});else{var p=$(r).parents(".field").attr("jump"),u=$(r).attr("accesskey");p>$("#dform").find(".field").length&&(p=$("#dform").find(".field").length);for(var f=parseInt(u);f<=parseInt(p);f++)$(".field[accesskey='"+f+"']").show()}$("div.ValError").html(""),$("#page"+t).hide(),$("#page"+d).show(),$("input[name='prev']",$("#page"+d)).attr("jb",t)}else{var v=!1;for(a=i;a<=Number($("#tpage").val())&&($(".field",$("#page"+a)).each(function(){"block"==$(this).css("display")&&(i=a,v=!0)}),!v);a++);$("div.ValError").html(""),$("#page"+i).show(),$("#page"+t).hide(),$("input[name='prev']",$("#page"+i)).attr("jb",t)}$("html, body").animate({scrollTop:0},"slow")}}function prevPage(e){var t=$(e).attr("accesskey").toString(),i=(parseInt($(e).attr("accesskey"))-1).toString();$(e).attr("jb")&&(i=$(e).attr("jb"),$(e).removeAttr("jb")),$("div.ValError").hide(),$("#page"+i).show(),$("#page"+t).hide(),scroll(0,0)}function validateSpecify(e){var t=$(e).parents("div.field");$("span.error",$(t)).hide(),$("span.field-label",$(t)).css("background",""),500<$(e).val().length&&($(e).val($(e).val().substr(0,500)),alert(res_500WordLimit))}function validate(e){var t=$(e).attr("accesskey").toString(),i=!0,a=!0,n="";if($(".field:visible",$("#page"+t+":visible")).each(function(){dform.validateQ($(this))||(i=!1,n+=$(this).attr("accesskey")+",")}),""!=n&&(n=n.substring(0,n.length-1),alert("請填寫您的電子信箱11")),$(document).find("input[dateOnly]").each(function(){a=DateIsValid($(this).val())&&a}),a){if(0==i&&($("input:button").removeAttr("disabled"),$("div.ValError").show()),1==i){if($("div.ValError").html(""),$("#addr_dist")){var r=$("#addr_dist :selected").text();$("#addr_dist option").each(function(){$(this).remove()}),$("#addr_dist").append("<option value="+r+">"+r+"</option>")}emailValidated?ROCIDValidated?mobileValidated?submitSurvey():alert(res_MobileIsInvalid):alert(res_PleaseEnterROCIDCorrectly):alert(res_EmailIsInvalid)}}else $("input:button").removeAttr("disabled"),$("div.ValError").html(res_PleaseCorrectTheDateField),$("div.ValError").show()}function show(e){for(var t=parseInt($(e).parents("div.field").attr("accesskey"))+1,i=$(e).attr("accesskey")?parseInt($(e).attr("accesskey"))-1:parseInt($(e).find("a").attr("accesskey"))-1,a=parseInt($(e).parents("div.field").attr("jump"))-1,n=t;n<=a;n++)$("div.field[accesskey="+n+"]").show(),$("div.section").each(function(){var e=parseInt($(this).attr("tabindex"))+1;1!=e&&e<=i&&t<=e&&$(this).hide()});showTitle(t,a,!0);for(var r=t;r<=i;r++)$("div.field[accesskey="+r+"]").hide(),$("div.section").each(function(){var e=parseInt($(this).attr("tabindex"))+1;1!=e&&e<=i&&t<=e&&$(this).hide()});showTitle(t,i,!1)}function hideAllSpecifyBox(){$("input.specifybox").each(function(){$(this).hide()})}function toggleInput(e){var t="mco"==$(e).attr("class")?$(e).find("a"):e;$("input:text",$(t)).is(":focus");if($(t).parents(".field").attr("ordered")){$(t).attr("class")&&""!=$(t).attr("class")||$(t).next().show();var i=$(e).parents(".field-content");""!=(a=$("input[type='hidden']",$(i)).val())?$("input[type='hidden']",$(i)).val(a+","+$(e).parent().parent().attr("order")):$("input[type='hidden']",$(i)).val($(e).parent().parent().attr("order")),fromSpecify=!1}else if($(t).attr("single"))$("input",$(t).parent()).show(),$("input",$(t).parent()).focus();else{$(t).attr("class")&&""!=$(t).attr("class")||($(t).find("input:text").show(),$(t).find("input:text").focus());var a;i=$(e).parents(".field-content");""!=(a=$("input[type='hidden']",$(i)).val())?$("input[type='hidden']",$(i)).val(a+","+$(e).parent().parent().attr("order")):$("input[type='hidden']",$(i)).val($(e).parent().parent().attr("order"))}}function submitSurvey(){RemoveNotSelectedSpecifyValue();var d="<survey>",l=!1;$(document).find(".field").each(function(){l="none"==$(this).css("display")&&!$(this).hasClass("needSubmit");var t=$(this).attr("ispk"),i=$(this).attr("isuk"),a=$(this).find(".field-label").text(),n=$(this).attr("id"),r="",s="";if(void 0===i&&(i="0"),0<$(".dateGroup",$(this)).length){var e=$('[name*="year"]',$(this)).val()+"/"+$('[name*="month"]',$(this)).val()+"/"+$('[name*="day"]',$(this)).val();2==e.length&&(e=""),d+='<naire id="'+$(this).attr("oid")+'" ispk="'+t+'" oid="'+$(this).attr("oid")+'">'+(l?"":e)+"</naire>"}else 0<$("select",$(this)).length&&$("select",$(this)).each(function(){if(0!=$("select",$(this)).attr("selectedIndex"))if("city"==$(this).attr("desc")){var e=0==$(":selected",$(this)).index()?"":$(":selected",$(this)).text();d+='<naire id="'+$(this).attr("id")+'" ispk="'+t+'" oid="'+n+'">'+(l?"":e)+"</naire>"}else"dist"==$(this).attr("desc")?d+='<naire id="'+$(this).attr("id")+'" ispk="'+t+'" oid="'+n+'">'+(l?"":$(":selected",$(this)).text())+"</naire>":d+='<naire id="'+$(this).attr("id")+'" ispk="'+t+'" oid="'+n+'">'+(l?"":$(":selected",$(this)).val())+"</naire>";else d+='<naire id="'+$(this).attr("id")+'" ispk="'+t+'" oid="'+n+'"></naire>'}),$("input",$(this)).each(function(){if(""!=$(this).attr("id")){var e=$(this).val();$(this).attr("dateonly")&&""!=$(this).val()&&(e=(e=Number($(this).val().substring(0,3))+1911).toString()+$(this).val().substring(3)),d+='<naire id="'+$(this).attr("id")+'" ispk="'+t+'" isuk="'+i+'" oid="'+n+'"><![CDATA['+(l?"":e.replace(/\'/g,"*singlequote*"))+"]]></naire>",$(this).attr("id")==s&&""!=r&&(d+=r,s=r="")}else s=n.replace("div_",""),r='<naire id="'+s+'_o" ispk="'+t+'" isuk="0" oid="'+n+'" label="'+a+'">'+(l?"":$(this).val().replace(/\'/g,"*singlequote*"))+"</naire>"}),0<$("textarea",$(this)).length&&(d+='<naire id="'+$("textarea",$(this)).attr("id")+'" ispk="'+t+'" oid="'+n+'"><![CDATA['+(l?"":$("textarea",$(this)).val().replace(/[\r\n]+/g," ").replace(/\'/g,"*singlequote*"))+"]]></naire>")}),$(document).find("input[question='false']").each(function(){d+='<naire id="'+$(this).attr("id")+'" ispk="'+$(this).attr("ispk")+'" isuk="0" oid="'+$(this).attr("id")+'">'+$(this).val()+"</naire>"}),d+="</survey>";var e='<input id="SID" name="SID" type="hidden"" value="'+$("#SID").val()+'" /><input id="rURL" name="rURL" type="hidden"" value="'+$("#rURL").val()+'" /><input id="clientID" name="clientID" type="hidden"" value="'+$("#clientID").val()+'" /><input id="campaignID" name="campaignID" type="hidden"" value="'+$("#campaignID").val()+'" /><input id="xml" name="xml" type="hidden"" value="'+encodeURIComponent(d)+'">';try{var t="g-recaptcha-response",i=$("#"+t).val();void 0!==i&&null!=i&&(e+='<input id="'+t+'" name="'+t+'" type="hidden"" value="'+i+'" />')}catch(e){}$("#dform").remove(),$("#form").html(e),document.forms.form.submit()}function checkMaxOption(e){var t=$(e).parents("div.field"),i=parseInt($(t).attr("maxOption")),a=$("a.selected",$(t)).size(),n=!1;return!$(e).hasClass("selected")&&$(t).attr("maxOption")&&(i<=a?(alert(res_MaxOptionReached),$(e).removeClass("selected"),$(e).next().hide(),n=!0):n=!1),n}function ReachedMaxOption(e){var t=$(e).parents("div.field"),i=parseInt($(t).attr("maxOption")),a=$("a.selected",$(t)).size(),n=!1;return!$(e).hasClass("selected")&&$(t).attr("maxOption")&&(i<=a?($(e).removeClass("selected"),$(e).next().hide(),n=!0):n=!1),n}function checkWithOrder(e){var t=$("input:text",$(e).parent()).is(":focus");$(e).attr("onclick")&&t||$(e).toggleClass("selected");var i=$(e).parents("ul"),a=!1,n=1,r=!1;if(-1==$(e).css("background-image").indexOf("check-on.png")&&$(e).css("background-image","url("+trackingServerAddress+"/surveycollector/images/check-off.png)"),$(e).hasClass("selected")){for(var s=1;s<=9;s++)if(a=!1,$(i).find("a").each(function(){-1!=$(this).css("background-image").indexOf(s+".png")&&(a=!0,9==s&&(r=!0))}),!a){n=s;break}r?(alert(res_reached9),$(e).removeClass("selected"),$(e).css("background-image","url("+trackingServerAddress+"/surveycollector/images/check-off.png)")):$(e).css("background-image","url("+trackingServerAddress+"/surveycollector/images/check_"+n+".png)"),$(e).trigger("change"),$(e).next().show()}else fromSpecify||($(e).next().hide(),$(e).next().val(""));fromSpecify=!1}$(document).ready(function(){collectorAddress=-1==location.protocol.indexOf("file:")?location.protocol+collectorAddress.substr(collectorAddress.indexOf("//")):collectorAddress,trackingServerAddress=-1==location.protocol.indexOf("file:")?location.protocol+trackingServerAddress.substr(trackingServerAddress.indexOf("//")):trackingServerAddress,$.ajaxSetup({async:!1}),"undefined"==typeof surveyIsValid||surveyIsValid||($("#dform").remove(),alert(res_ThisSurveyIsInvalid)),"undefined"!=typeof maxCountReached&&maxCountReached&&($("#dform").remove(),alert(res_MaxCountReached)),$("input[numbersOnly]").live("keydown",function(e){(e.shiftKey||e.ctrlKey||e.altKey||!(48<=e.keyCode&&e.keyCode<=57||96<=e.keyCode&&e.keyCode<=105))&&8!=e.keyCode&&9!=e.keyCode&&46!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&(/^\d+$/.test(e.char)||e.preventDefault())}),$("input[numbersOnly]").live("input",function(e){/^[a-z0-9]+$/i.test($(this).val())||$(this).val($(this).val().replace(/[^a-zA-Z0-9]/g,""))}),$("input[numbersOnly]").on("input",function(){isNaN(parseInt($(this).val()))&&$(this).val("")}),$("input[decimalOnly]").live("keydown",function(e){var t=e.charCode||e.keyCode||0;return 110==t||190==t?-1==$(this).val().indexOf("."):8==t||9==t||46==t||37<=t&&t<=40||48<=t&&t<=57||96<=t&&t<=105}),$(document).find(".field").each(function(){var e=$(".field-label",$(this)).text();if((-1!=e.indexOf("電子郵件")||-1!=e.toLowerCase().indexOf("email")||0<$('[isemail="true"]',$(this)).length)&&"1"===$(this).attr("type"))$("input",$(this)).focusout(function(){emailValidated=!0,$(".email").each(function(e,t){if(""==t.value)$(this).css("background-color","white");else{0==/^([a-zA-Z0-9_\.\-\'])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$/.test(t.value)?($(this).css("background-color","#F6CECE"),emailValidated=!1):$(this).css("background-color","white")}})}),$("input",$(this)).addClass("email");else if((-1!=e.indexOf("手機")||-1!=e.toLowerCase().indexOf("mobile")||0<$('[isphone="true"]',$(this)).length)&&"1"===$(this).attr("type"))$("input",$(this)).focusout(function(){mobileValidated=!0,$(".mobile").each(function(e,t){if(""==t.value)$(this).css("background-color","white");else{0==/^09\d{8}$/.test(t.value)&&0==/^1\d{10}$/.test(t.value)?($(this).css("background-color","#F6CECE"),mobileValidated=!1):$(this).css("background-color","white")}})}),$("input",$(this)).attr({numbersonly:"",maxlength:"11"}).addClass("mobile");else if(-1==e.indexOf("身分證")&&-1==e.indexOf("身份證")&&-1==e.toUpperCase().indexOf("ROC ID")||"1"!==$(this).attr("type")){if(-1!=e.indexOf("帳號密碼")||-1!=e.toLowerCase().indexOf("account password")){var t=$("input",$(this)).parent(),i=$("input",$(this)).parent().html();i=i.replace("text","password"),$("input",$(t)).remove(),$(t).html(i)}}else $("input",$(this)).focusout(function(){ROCIDValidated=!0,$(".rocid").each(function(e,t){checkROCID(t.value)?$(this).css("background-color","white"):($(this).css("background-color","#F6CECE"),ROCIDValidated=!1),""==$(this).val()&&0==$(this).parents(".fields").find(".req").length&&$(this).css("background-color","white")})}),$("input",$(this)).attr("maxlength",10).addClass("rocid")}),$("input[dateOnly]").each(function(){$(this).mask("999/99/99")}),$("input[dateOnly]").focusout(function(){DateIsValid($(this).val())||(alert(res_DateIsInvalid),$("span.error",$(this).parents(".field")).show(),$("span.field-label",$(this).parents(".field")).css("background","#FDF9CB"))}),$("div.field[hasrange=true]").each(function(){$("a[start]",$(this)).each(function(){var e=parseInt($(this).attr("start")),t=parseInt($(this).attr("end"));if(NaN!=typeof e&&NaN!=typeof t){showTitle(e,t,!1);for(var i=e;i<=t;i++)$("div.field[accesskey="+i+"]").hide()}})}),$('input[value="Submit"]').val("訂閱"),$('input[value="Next"]').val(res_NextPage),$('input[value="Prev"]').val(res_PreviousPage),$("#exposeMask").remove(),$("input.dateGroup[numbersOnly='true']").each(function(){$(this).blur(function(){var e="";try{null==(e=$(this).parents(".field").attr("dtype"))&&(e="")}catch(e){}var t=parseInt($(this).val());"17"==e?t<1900?$(this).val("1900"):2079<t&&$(this).val("2079"):t<1753?$(this).val("1753"):9999<t&&$(this).val("9999")})}),$("select").each(function(){$(this).parents(".field").attr("jump")&&show($(this).children(":selected"))});var e=parent.document.location.search.substring(1);if(""!=e)for(var t=e.split("&"),i=0;i<t.length;i++){var a=new Array("",""),n=decodeURIComponent(t[i]),r=n.indexOf("=");0<=r?(a[0]=n.substr(0,r),a[1]=n.substr(r+1)):a[0]=n,0!=$('[tag="'+a[0]+'"]').length&&$('[tag="'+a[0]+'"]').val(decodeURIComponent(a[1]))}}),$(function(){dform.initializeEvents()});var dform={initializeEvents:function(){var e=parseInt($("#tpage").val());for(i=2;i<=e;i++)$("#page"+i.toString()).hide();$("#ctlNext").click(function(){var e=$(this).attr("accesskey").toString();(parseInt($(this).attr("accesskey"))+1).toString();$("#action").val("1");var t=!0;$(".field:visible",$("#page"+e+":visible")).each(function(){0==dform.validateQ($(this))&&(t=!1)}),0==t&&($("input:button").removeAttr("disabled"),$("div.ValError").html("Please complete the required fields."),$("div.ValError").show()),1==t&&($("div.ValError").hide(),$("#page"+(parseInt($(this).attr("accesskey"))+1).toString()).show(),$("#page"+parseInt($(this).attr("accesskey")).toString()).hide())}),$("select").change(function(e){show($(this).children(":selected"))}),$("#ctlPrev").click(function(){$("#action").val("0"),$(".field:visible").each(function(){dform.validateQ($(this))}),$(".field:hidden").each(function(){dform.clearFieldValue($(this))}),$(".form").submit()}),this.setupValidationEvent(),$("input:text").live("keydown",function(e){13==e.keyCode&&e.preventDefault()}),$("input:password").live("keydown",function(e){13==e.keyCode&&e.preventDefault()}),-1!=navigator.appVersion.indexOf("Chrome/")&&$("table.matrix-rating").width()<300&&$("table.matrix-rating").width(300)},setupValidationEvent:function(){$("a.rate-off").click(function(){dform.ratingClick(this)}),$("li[class='mco']").click(function(){void 0!==$("a",$(this)).attr("multiple")?dform.checkboxClick($("a",$(this))):dform.radioClick($("a",$(this)))}),$(".field").each(function(){var e=$(this);if("1"==e.attr("req")){var t=e.attr("type");"1"==t?($("input:text",$(e)).blur(function(){dform.validateQ($(e))}),$("input:password",$(e)).blur(function(){dform.validateQ($(e))})):"2"==t?$("textarea",$(e)).blur(function(){dform.validateQ($(e))}):"4"==t?$("input:checkbox",$(e)).click(function(){dform.validateQ($(e))}):"7"==t&&$("select",$(e)).change(function(){dform.validateQ($(e))})}}),$("input:range").each(function(){$(this).rangeinput()})},ratingClick:function(e){$(e).parents("tr").find("a.rate-off").removeClass("rate-on"),$(e).toggleClass("rate-on"),$(e).trigger("change");var t=$(e).parents("div.field");$("span.error",$(t)).is(":visible")&&dform.validateQ(t)},radioClick:function(e){var t;$(e).parents("ul").find("a.selected").removeClass("selected"),$(e).addClass("selected"),$(e).trigger("change"),dform.validateQ($(e).parents("div.field")),t=$(e).attr("single")?$(e).parents("li.mco"):$(e),0<$("input",$(t)).length&&$("input",$(t)).focus(),$("input[onkeyup]",$(t).parents(".field")).each(function(){$(this).is(":focus")})},checkboxClick:function(e){$(e).parents(".field").attr("ordered")?checkMaxOption(e)||checkWithOrder($(e)):$(e).parents(".field").attr("maxoption")?checkMaxOption(e)||($(e).toggleClass("selected"),$(e).trigger("change")):"selected"!=$(e).attr("class")?($("input",$(e).parent()).show(),$(e).attr("class","selected")):$(e).attr("class","");var t=$(e).css("background-image").substring($(e).css("background-image").indexOf("/images/"),$(e).css("background-image").length-1);$(e).css("background-image",trackingServerAddress+"/surveycollector/"+t),dform.validateQ($(e).parents("div.field"))},GetBacktoServer:function(){var e=window.location.pathname,t=e.lastIndexOf("/"),i=e.substr(t+1,e.length-t),a=dform.readCookie("history");null!=a&&a.toLowerCase()!=i.toLowerCase()&&(window.location.href=window.location.href)},readCookie:function(e){for(var t=e+"=",i=document.cookie.split(";"),a=0;a<i.length;a++){for(var n=i[a];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},validateQ:function(e){var t=$(e).attr("req"),i=$(e).attr("type"),a=!0;if("1"==i){var n=$(e).attr("id");if(n=n.replace("div_",""),1<=$(e).find("#"+n+"_city").length)a=""!=$(e).find("#"+n+"_city").val()&&""!=$(e).find("#"+n+"_dist").val()&&""!=$(e).find("#"+n+"_zip").val()&&""!=$(e).find("#"+n+"_street").val();else if("CWAddr25078627"==n)a=""!=$(e).find("#city").val()&&""!=$(e).find("#country").val()&&""!=$(e).find("#postal_code").val()&&""!=$(e).find("#address").val();else if("CWAddr25068364"==n)a=""!=$(e).find("#city_o").val()&&""!=$(e).find("#country_o").val()&&""!=$(e).find("#country_o").val()&&""!=$(e).find("#address_o").val();else if(1<=$(e).find("#addr_city").length)a=""!=$(e).find("#addr_zip").val()&&""!=$(e).find("#addr_content").val();else if(1<=$(e).find("#birth_year").length)if(""==$("#birth_year").val()||0==$("#birth_month :selected",$(e)).index()||0==$("#birth_day :selected",$(e)).index())a=!1;else{new Date;a=""!=$(e).find("#birth_year").val()&&0!=$(e).find("#birth_month").attr("selectedIndex")&&0!=$(e).find("#birth_day").attr("selectedIndex")}else if(1<=$(e).find("input[dateOnly]").length)""==$(e).find("input[dateOnly]").val()?a=!1:DateIsValid($("input[dateOnly]",$(e)).val())||(a=!1);else if(0<$(e).find(".dateGroup").length){var r=!1;t="0",$(".dateGroup",$(e)).each(function(){"INPUT"==$(this)[0].tagName.toUpperCase()?0<$(this).val().length&&(r=!0):"SELECT"==$(this)[0].tagName.toUpperCase()&&""!=$(this).val()&&(r=!0)});var s=!0;r||"1"!=$(e).attr("req")||(s=!1),r&&$(".dateGroup",$(e)).each(function(){"INPUT"==$(this)[0].tagName.toUpperCase()?0==$(this).val().length&&(s=!1):"SELECT"==$(this)[0].tagName.toUpperCase()&&""==$(this).val()&&(s=!1)}),s||($(e).find(".field-label").css("background","yellow"),t="1"),a=!1}else a=0<$("input:password",$(e)).length?""!=$("input:password",$(e)).val():""!=$("input:text",$(e)).val()}else if("2"==i)a=0!=$("textarea",$(e)).val().length;else if("3"==i){if(a=this.validateList($(e),!1),0<$(e).find("input[type='text']").size()&&"1"==t){var d=$(e).find("a.selected");0<$(d).parents("li.mco").find("input[type='text']").size()&&(a=""!=$(d).parents("li.mco").find("input[type='text']").val())}}else if("4"==i)if(0!=$(e).find("[onclick]").length&&$(e).find("[onclick]").hasClass("selected"))if($(e).attr("ordered"))this.validateList($(e),!0),a=""!=$("a.selected",$(e)).parents("li.mco").find("input[type='text']").val();else{d=$("a.selected",$(e));a=!0;var l=$(e);$("input [type='hidden']",l).val("");d="";$("li.mco",$(l)).each(function(){$("a",$(this)).hasClass("selected")&&($(this).attr("oid")?d+=$(this).attr("oid")+",":d+=$(this).attr("order")+",")}),d=d.substring(0,d.length-1),$("input[type='hidden']",$(l)).val(d),0<$("a.selected",$(e)).parents("li.mco").find("input[type='text']").size()&&(a=""!=$("a.selected",$(e)).parents("li.mco").find("input[type='text']").val())}else a=this.validateList($(e),!0);else"5"==i?a=this.validateScaleRating($(e)):"6"==i?a=this.validateMatrix($(e)):"7"==i&&(a=0!=$("option:selected",$("select",$(e))).val().length);return a||"1"!=t?($("span.error",$(e)).hide(),$("span.field-label",$(e)).css("background","")):($("span.error",$(e)).show(),$("span.field-label",$(e)).css("background","#FFFF00")),"1"!=t||a},validateMatrix:function(i){var a,e=$("table.matrix-rating",$(i)),n=!0;return $("tr[tp='d']",e).each(function(){var e=$(this).attr("fid"),t=$("a.rate-on",$(this));a="",0==t.length?n=!1:(a=$(t).attr("dval"),$("#"+e,$(i)).attr("value",a))}),n},validateScaleRating:function(t){var i=!0,e=$("table.scale-rating",$(t));return $("tr[tp='d']",e).each(function(){var e=$("a.rate-on",$(this));0==e.length?i=!1:$("input:hidden",$(t)).attr("value",$(e).text())}),i},validateList:function(n,e){var t=$("ul.mc-select",$(n)),i=!0,a=$("a.selected",$(t)),r=$(n).attr("id").replace("div_","");if(0==a.length)i=!1,$("input[type='hidden']",$(t).parents(".field-content")).val(o);else if(e)if("true"==$(t).parents(".field").attr("ordered")){var s=parseInt($(t).parents(".field").attr("maxoption"));$("input[type='hidden']",$(t).parents(".field")).val(""),isNaN(s)&&(s=9);for(var d=0;d<=s;d++)$("a",$(t)).each(function(){var e,t=$(this).css("background-image").indexOf("check_");if($(this).css("background-image").substring(t+6,t+7)==d.toString()&&(""==$("input[type='hidden']",$(n)).val()?($(this).text(),e=$(this).parent().attr("oid")?$(this).parent().attr("oid")?$(this).parent().attr("oid"):$(this).parent().parent().attr("oid"):$(this).parent().attr("order")?$(this).parent().attr("order"):$(this).parent().parent().attr("order")):($("input[type='hidden']",$(n)).val()+","+$(this).text(),e=$(this).parent().attr("oid")?$(this).parent().attr("oid")?$("input[type='hidden']",$(n)).val()+","+$(this).parent().attr("oid"):$("input[type='hidden']",$(n)).val()+","+$(this).parent().parent().attr("oid"):$(this).parent().attr("order")?$("input[type='hidden']",$(n)).val()+","+$(this).parent().attr("order"):$("input[type='hidden']",$(n)).val()+","+$(this).parent().parent().attr("order")),$("input[id="+r+"]",$(n)).val(e),$(n).attr("maxOption")))for(var i=e.split(","),a=0;a<i.length;a++)$("input[id="+r+"_"+(a+1)+"]",$(n)).val(i[a])})}else{var l=$(t).parents(".field-content");0==l.length&&(l=$(t).parents(".field-content-horizontal")),$("input [type='hidden']",l).val("");var o="";$("li.mco",$(t)).each(function(){$("a",$(this)).hasClass("selected")&&($(this).attr("oid")?o+=$(this).attr("oid")+",":o+=$(this).attr("order")+",")}),o=o.substring(0,o.length-1),$("input[type='hidden']",$(l)).val(o)}else $(a).attr("fid")?$("input[type=hidden]",$(n)).val($(a).attr("fid")):$(a).parents("li.mco").attr("id")?$("input[type=hidden]",$(n)).val($(a).parents("li.mco").attr("id")):$("input[type=hidden]",$(n)).val($(a).parents("ul").find("li").index($(a).parents("li.mco"))+1),""==$("input",$(a).parents("li.mco")).val()&&(i=!1),$("input",$(a).parents("ul.mc-select")).each(function(){}),$(a).attr("single")?$(a).next().show():$(a).find("input").show();return i},clearFieldValue:function(e){var t=$(e).attr("type");"1"==t?$("input:text",$(e)).val(""):"2"==t?$("textarea",$(e)).val(""):"3"==t||"4"==t||"5"==t||"6"==t?$("input:hidden",$(e)).each(function(){$(this).val("")}):"7"==t?$("select",$(e)).val(""):"8"==t&&$("input.range",$(e)).val("")},clearField:function(e){var t=$(e).attr("type");"1"==t?$("input:text",$(e)).val(""):"2"==t?$("textarea",$(e)).val(""):"3"==t||"4"==t||"5"==t||"6"==t?($("input:hidden",$(e)).each(function(){$(this).val("")}),"3"==t?$(e).find("a.selected").removeClass("selected"):"4"==t?$("a[multiple].selected",$(e)).removeClass("selected"):$(e).find("a.rate-off").removeClass("rate-on"),$(e).trigger("change")):"7"==t?$("select",$(e)).val(""):"8"==t&&$("input.range",$(e)).val("")}};function checkROCID(e){if(""===e)return!0;var t,i,a,n=0;for(t=e.toUpperCase(),i=0;i<9;i++)0===i?(a="ABCDEFGHJKLMNPQRSTUVXYWZIO".indexOf(t.substring(0,1))+10,n+=Math.floor(a/10),n+=a%10*9):n+=parseInt(t.substr(i,1))*(9-i);return(n%10==0?0:10-n%10).toString()==t.substr(9,1)}function selectOption(e){$(e).prev().attr("class","selected")}function showHide(e){if(!ReachedMaxOption(e)){var t="mco"==$(e).attr("class")?$(e).find("a"):e,i=parseInt($(t).attr("start")),a=parseInt($(t).attr("end"));if(NaN!=typeof i&&NaN!=typeof a)if($(t).hasClass("selected")){for(n=i;n<=a;n++)$(document).find("div.field[accesskey="+n+"]").hide();checkIfTitleNeedsToHide(i,a,!1)}else{for(var n=i;n<=a;n++)$(document).find("div.field[accesskey="+n+"]").show();checkIfTitleNeedsToHide(i,a,!0)}"function"==typeof parent.calcHeight&&parent.calcHeight()}}function specifyFocused(e){fromSpecify=!0}function RemoveNotSelectedSpecifyValue(){$("ul.multiple").each(function(){$(this).find("input[onkeyup]").each(function(){0==$(this).parent().find("a.selected").length&&0==$(this).parent().parent().find("a.selected").length&&$(this).val("")})}),$("ul.single").each(function(){$(this).find("input[onkeyup]").each(function(){0==$(this).parent().find("a.selected").length&&0==$(this).parent().parent().find("a.selected").length&&$(this).val("")})})}function getFebDays(e){var t=$(e).parents(".field"),i=$(t).find('[name^="date_year"]').val(),a=$(t).find('[name^="date_month"]').val();if(""!=i&&""!=a){for(var n='<option selected value=""></option>',r=1;r<=getNumberOfDays(i,parseInt(a)-1);r++)n+='<option value="'+r+'">'+r+"</option>";$(t).find('[name^="date_day"]').html(n)}}function getNumberOfDays(e,t){return[31,e%4==0&&(e%100!=0||e%400==0)?29:28,31,30,31,30,31,31,30,31,30,31][t]}